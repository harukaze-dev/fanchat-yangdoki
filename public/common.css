/* public/common.css */

/* --- 기본 & 폰트 설정 --- */
:root {
  /* 메인 테마: 웜톤 오렌지 */
  --primary-color: #F37321; 
  --primary-hover: #D35400;
  --light-gray: #FFF3E0; 
  --border-color: #F5CBA7;
  
  /* 따뜻한 가판대/종이 느낌을 위한 색상 */
  --paper-bg: #FFFDF5;      /* 배경: 연한 크림색 */
  --paper-border: #D4B895;  /* 테두리: 연한 나무색 */
  --input-bg: #FFFEF0;      /* 입력창 배경 */
  
  --text-dark: #4A3B32;     /* 짙은 고동색 텍스트 */
  --text-light: #8D6E63;    /* 연한 갈색 텍스트 */
  
  /* 스트리머 테마 색상 */
  --danchu-color: #F4AABC;
  --collet-color: #DFB2FF;
  --hangyeol-color: #A5BDEF;
  --yangdoki-color: #96E1B8;
  
  --kick-color: #d9534f;
  --kick-hover: #c9302c;
  --danger-color: #EF5350;
  --danger-hover-color: #D32F2F;
}

body {
  margin: 0; font-family: 'Noto Sans KR', sans-serif;
  
  /* 배경 색상 (웜톤) */
  background-color: #FB9E44;
  background-image: linear-gradient(135deg, #FB9E44 0%, #F5A623 60%, #FFD180 100%);
      
  color: var(--text-dark); display: flex; justify-content: flex-start;
  align-items: center; min-height: 100vh; padding: 1rem;
  box-sizing: border-box; overflow-x: hidden;
  
  position: relative; 
}

body.in-chat { align-items: flex-start; }
.hidden { display: none !important; }

/* --- 배경 구름 스타일 (수정됨: 1.5배 확대 & 5개로 증가) --- */
.cloud-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; pointer-events: none; z-index: 0; }
.cloud { position: absolute; background: #fff; border-radius: 150px; opacity: 0.35; }
.cloud::after, .cloud::before { content: ''; position: absolute; background: #fff; border-radius: 50%; z-index: -1; }

/* Cloud 1 - 확대 */
.cloud-1 { width: 180px; height: 68px; top: 8%; left: 5%; }
.cloud-1::after { width: 75px; height: 75px; top: -38px; left: 22px; }
.cloud-1::before { width: 90px; height: 90px; top: -52px; left: 75px; }

/* Cloud 2 - 확대 */
.cloud-2 { width: 270px; height: 90px; top: 10%; left: 45%; }
.cloud-2::after { width: 120px; height: 120px; top: -68px; left: 38px; }
.cloud-2::before { width: 90px; height: 90px; top: -45px; left: 135px; }

/* Cloud 3 - 확대 */
.cloud-3 { width: 150px; height: 60px; top: 15%; left: 90%; }
.cloud-3::after { width: 60px; height: 60px; top: -30px; left: 15px; }
.cloud-3::before { width: 75px; height: 90px; top: -45px; left: 60px; }

/* Cloud 4 - 신규 추가 (대형) */
.cloud-4 { width: 300px; height: 100px; top: 70%; left: -5%; }
.cloud-4::after { width: 120px; height: 120px; top: -60px; left: 40px; }
.cloud-4::before { width: 140px; height: 140px; top: -80px; left: 140px; }

/* Cloud 5 - 신규 추가 (중형) */
.cloud-5 { width: 200px; height: 70px; top: 80%; left: 75%; }
.cloud-5::after { width: 90px; height: 90px; top: -40px; left: 30px; }
.cloud-5::before { width: 100px; height: 100px; top: -50px; left: 90px; }


/* --- 토스트 팝업 --- */
#toast-popup {
    position: fixed; top: 20px; right: 20px; background-color: var(--primary-color);
    color: white; padding: 1rem 1.5rem; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    z-index: 2000; font-weight: 700; opacity: 1; transform: translateY(0);
    transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
}
#toast-popup.hidden { opacity: 0; transform: translateY(-150px); }


/* --- 메인 메뉴 & 프로필 설정 공통 스타일 --- */
#main-menu{
    position: relative; 
    background: var(--paper-bg);
    border: 3px dashed var(--paper-border);
    
    padding: 0rem 3rem; 
    
    border-radius: 24px; 
    box-shadow: 0 10px 25px rgba(0,0,0,0.1), inset 0 0 30px rgba(210, 180, 140, 0.2);
    
    width: 100%; max-width: 420px;
    text-align: center; transition: all 0.3s ease;
    margin: 0 auto;
}

#profile-setup {
    position: relative; 
    background: var(--paper-bg);
    border: 3px dashed var(--paper-border);
    
    /* 텍스트 헤더 제거로 인해 padding 조정 */
    padding: 3rem 3rem 2rem 3rem; 
    
    border-radius: 24px; 
    box-shadow: 0 10px 25px rgba(0,0,0,0.1), inset 0 0 30px rgba(210, 180, 140, 0.2);
    
    width: 100%; max-width: 420px;
    text-align: center; transition: all 0.3s ease;
    margin: 0 auto;
}

/* --- 프레임 이미지 (title01.png) --- */
.main-menu-frame {
    position: absolute;
    object-fit: fill;
    z-index: 20; /* 배경 위 */
    pointer-events: none; 
    filter: drop-shadow(5px 10px 15px rgba(0, 0, 0, 0.2));
}

/* --- 로비 타이틀 이미지 (title03.png) --- */
.main-menu-title {
    position: absolute;
    top: -130px; /* 프레임 위쪽으로 배치 */
    left: 50%;
    transform: translateX(-50%); /* 가로 중앙 정렬 */
    width: 80%; /* 크기 조절 */
    height: auto;
    z-index: 50; /* 프레임(20)보다 높게 설정하여 맨 앞에 표시 */
    filter: drop-shadow(0 5px 5px rgba(0,0,0,0.2));
}

/* --- 내부 컨텐츠 래퍼 --- */
.lobby-content-wrapper {
    position: relative;
    z-index: 30; 
    width: 100%;
    height: 100%;
}

/* 메인 메뉴 위치 및 레이아웃 */
#main-menu {
    transform: translateX(-80px);
    z-index: 1; 
    min-height: 400px;
    display: flex; flex-direction: column; justify-content: center;
}

/* 우측 캐릭터 데코 */
.main-menu-deco {
    position: absolute;
    top: 90px; right: -230px;
    height: 80%; width: auto;
    z-index: 5; pointer-events: none;
}

/* 1. 메인 메뉴 (로비) 프레임 조절 */
#main-menu .main-menu-frame {
    top: -55px;
    left: -45px;
    width: calc(100% + 90px);
    height: calc(100% + 130px);
}

/* 2. 프로필 설정 화면 프레임 조절 (텍스트 삭제로 높이 축소) */
#profile-setup .main-menu-frame {
    top: -100px;
    left: -40px;
    width: calc(100% + 80px);
    height: calc(100% + 210px);
}

/* 모바일 반응형 */
@media (max-width: 900px) {
    #main-menu { transform: none; margin: 4rem auto; }
    .main-menu-deco { display: none; }
    .main-menu-frame { width: calc(100% + 40px); left: -20px; }
}

/* 내부 요소들 스타일 */
.lobby-header { margin-bottom: 1.5rem; }
.lobby-header h1 { font-size: 1.8rem; font-weight: 800; margin: 0 0 0.5rem 0; color: var(--text-dark); letter-spacing: -0.5px; }
.lobby-header p { font-size: 1rem; color: var(--text-light); margin: 0; font-weight: 500; }

.form-group { margin-bottom: 1.25rem; }
.form-label { font-weight: 600; color: var(--text-dark); margin-bottom: 0.5rem; display: block; }

/* 버튼 스타일 */
.main-menu-btn, #join-form button, #confirm-profile-btn { 
    width: 100%; padding: 1rem;
    background: var(--primary-color); 
    color: white; border: none; border-radius: 12px;
    font-size: 1.1rem; font-weight: 700; cursor: pointer; 
    transition: all 0.2s ease-in-out; 
    box-shadow: 0 4px 0px #C25E00;
}
.main-menu-btn:hover, #join-form button:hover, #confirm-profile-btn:hover { 
    background: var(--primary-hover); transform: translateY(2px); box-shadow: 0 2px 0px #C25E00; 
}
.main-menu-btn:active, #join-form button:active, #confirm-profile-btn:active {
    transform: translateY(4px); box-shadow: none;
}

/* 2차 버튼 (뒤로가기 등) */
.secondary-btn {
    width: 100%; padding: 1rem; /* 높이 맞춤 */
    background: transparent; color: var(--text-light);
    border: 2px solid var(--paper-border); border-radius: 12px; font-size: 1rem;
    font-weight: 700; cursor: pointer; transition: all 0.2s ease-in-out; 
    /* margin-top 제거 (가로 배치 위함) */
    margin-top: 0; 
}
.secondary-btn:hover { background: rgba(243, 115, 33, 0.1); color: var(--primary-color); border-color: var(--primary-color); }

/* 버튼 가로 배치 그룹 */
.profile-btn-group {
    display: flex;
    gap: 10px;
    margin-top: 1rem;
}
.profile-btn-group > button {
    flex: 1; /* 균등 분할 */
}

.divider { margin: 1.5rem 0; color: var(--text-light); font-weight: 600; display: flex; align-items: center; text-align: center; }
.divider::before, .divider::after { content: ''; flex: 1; border-bottom: 2px dashed var(--paper-border); }

#join-form { display: flex; flex-direction: column; gap: 0.75rem; }
#room-code-input, #streamer-key-input { 
    text-align: center; font-size: 1.2rem; text-transform: uppercase; width: 100%; 
    padding: 1rem; border-radius: 12px; border: 2px solid var(--paper-border); 
    background-color: var(--input-bg); color: var(--text-dark);
    box-sizing: border-box; transition: all 0.3s;
}
#room-code-input:focus, #streamer-key-input:focus { 
    outline: none; border-color: var(--primary-color); background-color: #fff;
    box-shadow: 0 0 0 3px rgba(243, 115, 33, 0.1);
}
#room-code-input[type="password"], #streamer-key-input[type="password"] { font-family: 'Verdana', sans-serif; letter-spacing: 2px; }
#room-code-input::placeholder, #streamer-key-input::placeholder { letter-spacing: normal; text-transform: none; color: #BCAAA4; }

.role-selection { display: flex; gap: 1rem; }
.role-selection input[type="radio"] { display: none; }
.role-label { 
    flex: 1; padding: 0.75rem; 
    border: 2px solid var(--paper-border); border-radius: 12px; cursor: pointer; 
    font-weight: 600; transition: all 0.2s ease-in-out; text-align: center; 
    background: var(--input-bg); color: var(--text-light);
}
.role-selection input[type="radio"]:checked + .role-label { 
    background-color: #FFF3E0; border-color: var(--primary-color); 
    color: var(--primary-color); box-shadow: 0 0 0 2px rgba(243, 115, 33, 0.1); 
}

select, #nickname-input { 
    width: 100%; padding: 0.8rem 1rem; border-radius: 8px; 
    border: 2px solid var(--paper-border); background-color: var(--input-bg); 
    box-sizing: border-box; font-size: 1rem; font-family: 'Noto Sans KR', sans-serif; 
    color: var(--text-dark); appearance: none; 
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%238D6E63' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); 
    background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em; 
}
select:focus, #nickname-input:focus { outline: none; border-color: var(--primary-color); background-color: #fff; box-shadow: 0 0 0 3px rgba(243, 115, 33, 0.1); }

#fan-options { display: flex; gap: 1rem; }
.profile-preview-container { margin: 1.5rem 0; }
#profile-preview { width: 120px; height: 120px; border-radius: 50%; border: 5px solid #fff; box-shadow: 0 4px 15px rgba(0,0,0,0.15); object-fit: cover; transition: all 0.3s ease; }
#profile-preview:hover { transform: scale(1.05); }

/* --- 설정 메뉴 및 기타 스타일 (기존 유지) --- */
.settings-container { position: relative; }
.settings-menu { position: absolute; top: calc(100% + 5px); right: 0; width: 180px; background-color: #40444b; border: 1px solid #2f3136; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); z-index: 1100; padding: 0.5rem; display: flex; flex-direction: column; gap: 0.25rem; }
.settings-menu button { width: 100%; background: none; border: none; color: #dcddde; padding: 0.75rem; text-align: left; border-radius: 5px; cursor: pointer; font-size: 0.95rem; font-family: 'Noto Sans KR', sans-serif; transition: background-color 0.2s, color 0.2s; display: flex; align-items: center; gap: 0.75rem; }
.settings-menu button:hover { background-color: #4f545c; }
.settings-menu button.danger { color: white; background-color: var(--danger-color); font-weight: 700; }
.settings-menu button.danger:hover { background-color: var(--danger-hover-color); }

/* --- 공용 모달 --- */
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); display: flex; justify-content: center; align-items: center; z-index: 1000; }
.modal-content { position: relative; background-color: #36393f; color: #dcddde; padding: 2rem; border-radius: 10px; width: 90%; max-width: 500px; text-align: center; }
.modal-content h2 { margin-top: 0; }
.modal-content > p { margin-top: 0.5rem; margin-bottom: 1.5rem; color: #b9bbbe; }
.modal-close-btn { position: absolute; top: 1rem; right: 1rem; background: none; border: none; color: #b9bbbe; font-size: 2rem; line-height: 1; cursor: pointer; transition: color 0.2s; }
.modal-close-btn:hover { color: white; }
#player-list-container { display: flex; flex-direction: column; gap: 0.75rem; margin-top: 1.5rem; max-height: 50vh; overflow-y: auto; padding: 0.5rem; background-color: #2f3136; border-radius: 5px; }
.player-list-item { display: flex; align-items: center; background-color: #40444b; padding: 0.75rem; border-radius: 5px; transition: background-color 0.2s; }
.player-list-item:hover { background-color: #4f545c; }
.player-pfp { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; margin-right: 1rem; }
.player-name { flex-grow: 1; font-weight: 500; text-align: left; }
.kick-btn { background-color: var(--kick-color); color: white; border: none; border-radius: 5px; padding: 0.4rem 0.8rem; cursor: pointer; font-weight: 700; transition: background-color 0.2s; }
.kick-btn:hover { background-color: var(--kick-hover); }

/* --- 공용 메시지 스타일 --- */
.messages { list-style-type: none; margin: 0; padding: 1.5rem; overflow-y: auto; flex-grow: 1; min-height: 0; }
.message-item { display: flex; align-items: center; margin-bottom: 0.4rem; max-width: 90%; gap: 12px; }
.streamer-message { margin-left: auto; flex-direction: row-reverse; }
.sender-info { display: flex; flex-direction: column; align-items: center; flex-shrink: 0; position: relative; }
.chat-pfp { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; background-color: white; border: 1px solid #cccccc; padding: 2px; box-sizing: border-box; }
.chat-pfp.clickable { cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; }
.chat-pfp.clickable:hover { transform: scale(1.1); box-shadow: 0 0 10px var(--primary-color); }
.chat-nickname { font-size: 0.85em; margin-top: -12px; padding: 1px 8px; border-radius: 5px; max-width: 80px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; transition: background-color 0.2s, color 0.2s; border: 1px solid #999; background-color: #cccccc; color: #111111; position: relative; z-index: 1; }
.streamer-hangyeol .chat-nickname, .fan-group-hangyeolfan .chat-nickname { background-color: var(--hangyeol-color); color: white; border-color: var(--hangyeol-color); text-shadow: 0px 1px 2px rgba(0,0,0,0.5); }
.streamer-danchu .chat-nickname, .fan-group-danchufan .chat-nickname { background-color: var(--danchu-color); color: white; border-color: var(--danchu-color); text-shadow: 0px 1px 2px rgba(0,0,0,0.5); }
.streamer-collet .chat-nickname, .fan-group-colletfan .chat-nickname { background-color: var(--collet-color); color: white; border-color: var(--collet-color); text-shadow: 0px 1px 2px rgba(0,0,0,0.5); }
.streamer-yangdoki .chat-nickname, .fan-group-yangdokifan .chat-nickname { background-color: var(--yangdoki-color); color: #333; border-color: var(--yangdoki-color); }
.message-bubble { position: relative; border-radius: 14px; padding: 8px 14px; background: linear-gradient(to bottom, #e4e6eb, #f0f2f5); box-shadow: 0 0 0 4px white, 0 1px 2px rgba(0, 0, 0, 0.15); transition: background 0.3s ease-in-out, box-shadow 0.3s ease-in-out; }
.chat-message-text { margin: 0; font-size: 1em; line-height: 1.45; word-wrap: break-word; color: #333; }
.streamer-message .chat-message-text { color: #ffffff; text-shadow: 0px 1px 2px rgba(0, 0, 0, 0.6); }
.streamer-yangdoki .chat-message-text { color: #333; text-shadow: none; }
.message-bubble::before { content: ""; position: absolute; top: 50%; transform: translateY(-50%); width: 0; height: 0; border-style: solid; transition: border-color 0.3s ease-in-out; }
.message-item:not(.streamer-message) .message-bubble::before { left: -8px; border-width: 8px 10px 8px 0; border-color: transparent #e4e6eb transparent transparent; }
.streamer-message .message-bubble::before { right: -8px; border-width: 8px 0 8px 10px; border-color: transparent transparent transparent #AAB1E5; }
.streamer-hangyeol .message-bubble { background: var(--hangyeol-color); }
.streamer-danchu .message-bubble { background: var(--danchu-color); }
.streamer-collet .message-bubble { background: var(--collet-color); }
.streamer-yangdoki .message-bubble { background: var(--yangdoki-color); }
.streamer-danchu .message-bubble::before { border-left-color: var(--danchu-color); }
.streamer-collet .message-bubble::before { border-left-color: var(--collet-color); }
.streamer-yangdoki .message-bubble::before { border-left-color: var(--yangdoki-color); }

/* --- 시스템 메시지 스타일 --- */
.system-message { display: flex; align-items: center; justify-content: center; gap: 0.5em; margin: 0.5rem auto; }
.system-pfp { width: 24px; height: 24px; border-radius: 50%; background-color: white; border: 1px solid #999; padding: 1px; box-sizing: border-box; }
.system-nickname { font-weight: 700; font-style: normal; padding: 2px 8px; border-radius: 5px; background-color: #cccccc; color: #111111; border: 1px solid #999; }
.system-text { color: #96989d; font-style: italic; font-size: 0.95em; }
.system-nickname.streamer-hangyeol, .system-nickname.fan-group-hangyeolfan { background-color: var(--hangyeol-color); color: white; border-color: var(--hangyeol-color); text-shadow: 0px 1px 2px rgba(0,0,0,0.5); }
.system-nickname.streamer-danchu, .system-nickname.fan-group-danchufan { background-color: var(--danchu-color); color: white; border-color: var(--danchu-color); text-shadow: 0px 1px 2px rgba(0,0,0,0.5); }
.system-nickname.streamer-collet, .system-nickname.fan-group-colletfan { background-color: var(--collet-color); color: white; border-color: var(--collet-color); text-shadow: 0px 1px 2px rgba(0,0,0,0.5); }
.system-nickname.streamer-yangdoki, .system-nickname.fan-group-yangdokifan { background-color: var(--yangdoki-color); color: #333; border-color: var(--yangdoki-color); }

.game-message { text-align: center; padding: 0.8rem 1.5rem; margin: 1rem auto; border-radius: 10px; font-size: 1.1em; font-weight: 700; color: white; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); border: 2px solid rgba(255,255,255,0.5); }
.game-message-success { background: linear-gradient(45deg, #f7971e, #ffd200); }
.game-message-reveal { background: linear-gradient(45deg, #6a11cb, #2575fc); }
.game-message-fail { background: linear-gradient(45deg, #6c757d, #343a40); }
.game-message strong { font-weight: 900; color: #ffeb3b; }
.game-message span { font-style: italic; color: #c7d2fe; }
.game-message-pfp { display: block; width: 120px; height: 120px; border-radius: 50%; margin: 1rem auto 0; border: 4px solid rgba(255, 255, 255, 0.7); box-shadow: 0 4px 15px rgba(0,0,0,0.3); object-fit: cover; }

/* 공용 스크롤바 */
.messages::-webkit-scrollbar, #fan-card-container::-webkit-scrollbar, #player-list-container::-webkit-scrollbar, #game-over-body::-webkit-scrollbar, #other-fans-list::-webkit-scrollbar { width: 8px; }
.messages::-webkit-scrollbar-track, #fan-card-container::-webkit-scrollbar-track, #player-list-container::-webkit-scrollbar-track, #game-over-body::-webkit-scrollbar-track, #other-fans-list::-webkit-scrollbar-track { background: #2f3136; border-radius: 10px; }
.messages::-webkit-scrollbar-thumb, #fan-card-container::-webkit-scrollbar-thumb, #player-list-container::-webkit-scrollbar-thumb, #game-over-body::-webkit-scrollbar-thumb, #other-fans-list::-webkit-scrollbar-thumb { background-color: #6c757d; border-radius: 10px; border: 2px solid #2f3136; }
.messages::-webkit-scrollbar-thumb:hover, #fan-card-container::-webkit-scrollbar-thumb:hover, #player-list-container::-webkit-scrollbar-thumb:hover, #game-over-body::-webkit-scrollbar-thumb:hover, #other-fans-list::-webkit-scrollbar-thumb:hover { background-color: var(--primary-color); }

.guess-tag { position: absolute; top: 2px; left: 4px; background-color: rgba(0, 0, 0, 0.75); color: white; font-size: 0.7rem; font-weight: bold; padding: 2px 6px; border-radius: 5px; z-index: 2; pointer-events: none; white-space: nowrap; border: 1px solid #fff; transform: none; }

/* 볼륨 조절 UI */
.volume-btn { position: relative; background: none; border: none; font-size: 1.2rem; cursor: pointer; color: white; padding: 0.5rem; line-height: 1; }
.vertical-slider-container { display: none; position: absolute; top: calc(100% + 5px); left: 50%; transform: translateX(-50%); background-color: #2f3136; padding: 1rem 0.5rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.3); z-index: 1200; }
.volume-btn:hover .vertical-slider-container { display: block; }
.volume-slider-vertical { -webkit-appearance: none; appearance: none; width: 8px; height: 100px; background: #5c677d; outline: none; border-radius: 3px; -webkit-writing-mode: vertical-bt; writing-mode: vertical-bt; }
.volume-slider-vertical::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 18px; height: 18px; background: #ffffff; cursor: pointer; border-radius: 50%; border: 1px solid #b9bbbe; }
.volume-slider-vertical::-moz-range-thumb { width: 18px; height: 18px; background: #ffffff; cursor: pointer; border-radius: 50%; border: 1px solid #b9bbbe; }

/* TTS 재생 강조 */
.message-item.speaking .message-bubble { background: #fefce8; box-shadow: 0 0 0 4px #facc15, 0 1px 2px rgba(0, 0, 0, 0.15); }
.message-item.speaking:not(.streamer-message) .message-bubble::before { border-right-color: #fefce8; }
.message-item.speaking.streamer-message .message-bubble::before { border-left-color: #fefce8; }